<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Asistente Voz IA - Administrador</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 15px; background-color: #f8f9fa; }
        .card { background: white; border-radius: 8px; padding: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .header { color: #0078d4; font-weight: bold; border-bottom: 2px solid #0078d4; margin-bottom: 10px; padding-bottom: 5px; }
        
        /* Contenedores de funciones */
        .ai-section { margin-top: 15px; padding: 10px; background: #e1f1ff; border-radius: 5px; }
        .content-area { height: 120px; overflow-y: auto; border: 1px solid #ddd; padding: 8px; font-size: 13px; background: #fff; margin-bottom: 10px; }
        
        /* Botones Pro */
        .btn { border: none; padding: 10px; border-radius: 4px; cursor: pointer; width: 100%; font-weight: 600; margin-bottom: 8px; transition: 0.3s; }
        .btn-primary { background: #0078d4; color: white; }
        .btn-ai { background: #512da8; color: white; } /* Color para IA */
        .btn-stop { background: #d83b01; color: white; }
        .btn:hover { opacity: 0.8; }
        
        .badge { display: inline-block; padding: 2px 8px; border-radius: 10px; font-size: 11px; background: #333; color: #fff; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="card">
        <div class="header">üéôÔ∏è ASISTENTE DE VOZ IA</div>
        <div id="badge-tipo" class="badge">Detectando tipo de correo...</div>
        
        <div id="content" class="content-area">Selecciona un correo para analizar...</div>
        
        <button id="btn-read" class="btn btn-primary">üîä LEER CORREO COMPLETO</button>
        
        <div class="ai-section">
            <div style="font-weight: bold; font-size: 12px; margin-bottom: 5px;">INTELIGENCIA ARTIFICIAL:</div>
            <button id="btn-resumen" class="btn btn-ai">‚ú® RESUMEN INTELIGENTE</button>
            <button id="btn-analizar" class="btn btn-ai">üîç ANALIZAR TONO Y PRIORIDAD</button>
        </div>

        <button id="btn-stop" class="btn btn-stop" style="margin-top: 15px;">‚èπÔ∏è DETENER VOZ</button>
    </div>

    <script>
        Office.onReady((info) => {
            if (info.host === Office.HostType.Outlook) {
                cargarDatos();
            }
        });

        function cargarDatos() {
            const item = Office.context.mailbox.item;
            document.getElementById('badge-tipo').innerText = "Correo: " + (item.itemType === "message" ? "Mensaje" : "Cita");
            
            item.body.getAsync(Office.CoercionType.Text, (result) => {
                if (result.status === Office.AsyncResultStatus.Succeeded) {
                    document.getElementById('content').innerText = result.value;
                }
            });
        }

        // --- L√ìGICA DE VOZ Y FUNCIONES ---
        
        const synth = window.speechSynthesis;

        function hablar(texto) {
            synth.cancel();
            const utterance = new SpeechSynthesisUtterance(texto);
            utterance.lang = 'es-ES';
            synth.speak(utterance);
        }

        document.getElementById('btn-read').onclick = () => {
            const texto = document.getElementById('content').innerText;
            hablar(texto);
        };

        document.getElementById('btn-resumen').onclick = () => {
            const texto = document.getElementById('content').innerText;
            // Aqu√≠ se conectar√° con el backend de IA, por ahora simulaci√≥n avanzada
            const resumen = "Resumen IA: Este correo trata sobre " + texto.substring(0, 50) + "... En conclusi√≥n, requiere su atenci√≥n inmediata.";
            document.getElementById('content').innerText = resumen;
            hablar(resumen);
        };

        document.getElementById('btn-analizar').onclick = () => {
            // L√≥gica de an√°lisis de sentimiento/prioridad
            const alerta = "An√°lisis de IA: Tono Formal, Prioridad Alta. El remitente espera una respuesta r√°pida.";
            hablar(alerta);
            alert(alerta);
        };

        document.getElementById('btn-stop').onclick = () => synth.cancel();

    </script>
</body>
</html>